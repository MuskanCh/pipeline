node {
    try {
        notifyBuild('STARTED')

        stage('SCM Checkout'){
            git branch: 'main', credentialsId: 'de47bbde-eb33-42de-9e27-51ba9d05924e',
            url: 'https://github.com/MuskanCh/pipeline.git'
        }
        stage('pull'){
            sh 'sudo docker run hello-world'
        }
        stage('deploy'){
            sh 'microk8s kubectl apply -f deployment.yml'
        }   
    } 
    catch (e) {
        currentBuild.result = "FAILED"
        throw e
    } 
    finally {
        notifyBuild(currentBuild.result)
    }
}
def notifyBuild(String buildStatus = 'STARTED') {
  def summary = "${buildStatus}: Job '${env.JOB_NAME} [${env.BUILD_NUMBER}] [${env.BUILD_URL}]'"
  slackSend (color: colorCode, message: summary)
}

